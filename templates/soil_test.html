<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <title>Soil Testing</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="{{ url_for('static', filename='script.js') }}" defer></script>

    
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4fff4; text-align: center; margin: 0; }
        header { background-color: #0f5e1e; color: white; padding: 20px; text-align: center; }
        header h1 { margin: 0; font-size: 1.8em; font-weight: bold; }
        form { margin-top: 30px; background: #ffffff; display: inline-block; padding: 20px; border-radius: 10px; box-shadow: 0px 0px 10px rgba(0,0,0,0.2); }
        input[type="number"], input[type="text"] { padding: 8px; margin: 5px; width: 200px; }
        input[type="button"] { padding: 10px 20px; margin-top: 10px; background: green; color: white; border: none; border-radius: 5px; cursor: pointer; }
        input[type="button"]:hover { background: darkgreen; }
        .back-btn { display: inline-block; margin-top: 20px; text-decoration: none; background: #4CAF50; color: white; padding: 8px 15px; border-radius: 5px; }
        .back-btn:hover { background: #2e8b57; text-decoration: underline; }
        #result { margin-top: 20px; font-weight: bold; color: #2e8b57; }
    </style>
</head>
<body>
    <header>
        <h1>Soil Testing</h1>
    </header>

    <p>Enter your soil details to get recommendations.</p>

    <div class="soil-container" style="max-width: 800px; margin: 0 auto; padding: 20px;">
        <form id="soilForm">
            <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between;">
                <div style="flex: 1; min-width: 200px;">
                    <label for="ph">pH Level</label>
                    <input type="number" id="ph" step="0.1" min="0" max="14" placeholder="e.g., 6.5">
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label for="n">Nitrogen (ppm)</label>
                    <input type="number" id="n" min="0" placeholder="e.g., 50">
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label for="p">Phosphorus (ppm)</label>
                    <input type="number" id="p" min="0" placeholder="e.g., 30">
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label for="k">Potassium (ppm)</label>
                    <input type="number" id="k" min="0" placeholder="e.g., 60">
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label for="organic">Organic Matter (%)</label>
                    <input type="number" id="organic" step="0.1" min="0" max="100" placeholder="e.g., 3.5">
                </div>
            </div>
            <input type="button" value="Analyze Soil" onclick="checkSoil()" style="margin-top: 20px; width: 200px;">
        </form>
    </div>

    <a href="{{ url_for('home') }}" class="back-btn">⬅ Back</a>

    <div id="result"></div>

    <script>
        function checkSoil() {
            let ph = parseFloat(document.getElementById("ph").value);
            let n = parseFloat(document.getElementById("n").value);
            let p = parseFloat(document.getElementById("p").value);
            let k = parseFloat(document.getElementById("k").value);
            let organic = parseFloat(document.getElementById("organic").value);
            
            if (isNaN(ph) || isNaN(n) || isNaN(p) || isNaN(k) || isNaN(organic)) {
                document.getElementById("result").innerHTML = "⚠ Please fill in all fields with valid numbers";
                return;
            }

            let issues = [];
            let recommendations = [];

            if (ph < 6.0) { issues.push("Acidic soil"); recommendations.push("Add agricultural lime to raise pH"); }
            else if (ph > 7.5) { issues.push("Alkaline soil"); recommendations.push("Add sulfur to lower pH"); }

            if (n < 40) { issues.push("Low nitrogen"); recommendations.push("Apply nitrogen-rich fertilizer"); }
            else if (n > 80) { issues.push("High nitrogen"); recommendations.push("Reduce nitrogen fertilizer application"); }

            if (p < 20) { issues.push("Low phosphorus"); recommendations.push("Add rock phosphate or bone meal"); }
            else if (p > 40) { issues.push("High phosphorus"); recommendations.push("Avoid phosphorus-rich fertilizers"); }

            if (k < 40) { issues.push("Low potassium"); recommendations.push("Add potash or wood ash"); }
            else if (k > 80) { issues.push("High potassium"); recommendations.push("Reduce potassium fertilizer application"); }

            if (organic < 3) { issues.push("Low organic matter"); recommendations.push("Add compost and cover crops"); }
            else if (organic > 5) { recommendations.push("Good organic matter content - maintain current practices"); }

            let resultHTML = '<div style="text-align: left; padding: 20px; background: white; border-radius: 10px; margin-top: 20px;">';
            if (issues.length === 0) {
                resultHTML += '<h3 style="color: #2e7d32;">✅ Soil Analysis Result</h3>';
                resultHTML += '<p>Your soil is in good condition for most crops. Keep up the good work!</p>';
            } else {
                resultHTML += '<h3 style="color: #f57c00;">⚠ Soil Analysis Result</h3>';
                resultHTML += '<h4>Issues Identified:</h4><ul>' + issues.map(issue => `<li>${issue}</li>`).join('') + '</ul>';
            }

            if (recommendations.length > 0) {
                resultHTML += '<h4>Recommendations:</h4><ul>' + recommendations.map(rec => `<li>${rec}</li>`).join('') + '</ul>';
            }

            resultHTML += '<h4>Suitable Crops:</h4>';
            if (5.5 <= ph && ph <= 7.0 && n >= 40 && p >= 20 && k >= 40) {
                resultHTML += '<p>✅ Most crops will grow well, including:</p><ul><li>Cereals: Rice, Wheat, Maize</li><li>Vegetables: Tomatoes, Peppers, Leafy Greens</li><li>Legumes: Beans, Peas</li></ul>';
            } else {
                resultHTML += '<p>⚠ Limited crop selection until soil is improved. Consider:</p><ul>';
                if (ph < 6.0) resultHTML += '<li>Acid-tolerant: Potatoes, Strawberries</li>';
                if (ph > 7.0) resultHTML += '<li>Alkaline-tolerant: Cabbage, Cauliflower</li>';
                if (n < 40) resultHTML += '<li>Low-nitrogen: Legumes</li>';
                resultHTML += '</ul>';
            }

            resultHTML += '</div>';
            document.getElementById("result").innerHTML = resultHTML;
        }
    </script>
</body>
</html>
